<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, user-scalable=yes">
<title>note - vlookup時の0とエラーの両方に対して代替を行う方法</title>
<link rel="stylesheet" href="/public/css/base.css">
    </head>
    <body>
        <h1><a href="/">note</a></h1>

        <div class="content">
            <h2 class="title">vlookup時の0とエラーの両方に対して代替を行う方法</h2>
            <div class="description">
                　Date：2014-04-23 17:29:37 +0900<br />
                　Categories： TECHNOLOGY <br />
                
            </div>
            <p>今まで知らなかったんですが、vlookupって見つからないとエラーを返すだけだと思ってIFERRORだけしか確認していなかったのですが、<br />
エラーが出るのは検索語が検索範囲から見つからなかった時の返り値だったみたいです。<br />
検索後は範囲内にあるけども、返り値を指定する位置に返すための何かがない場合は0が返るので、その両方に対してIF文で大体の文字列を入れたのが以下です。</p>
<pre style="background-color:#2b303b;">
<span style="color:#c0c5ce;">=IF(
</span><span style="color:#c0c5ce;">ISERROR(vlookup(検索語,範囲,位置,True or False)),&quot;該当なし&quot;, IF(
</span><span style="color:#c0c5ce;">vlookup(検索語,範囲,位置,True or False)=0,&quot;なし&quot;,vlookup(検索語,範囲,位置,True or False)
</span><span style="color:#c0c5ce;">)
</span><span style="color:#c0c5ce;">)
</span></pre>
<p>さきほどの<br />
・検索語がみつからないエラーは =&gt; 「該当なし」<br />
・検索した返り値が空っぽの場合は =&gt; 「なし」</p>
<p>というふうになります。</p>

            <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-show-count="false">Tweet</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
        </div>
        <div class="footer">
            <a href="/">TOP</a>
        </div>
    </body>
</html>
