---
title: "clasp äº‹å§‹ã‚"
layout: posts.liquid
is_draft: false
published_date: 2021-01-11 12:01:51 +0900
categories: ["TECHNOLOGY"]
tags: []
---

## claspã¨ã¯
Google App Scriptã‚’ãƒ­ãƒ¼ã‚«ãƒ«ãƒã‚·ãƒ³ã§ä¾¿åˆ©ã«ä½¿ãˆã‚‹ã‚ˆã†ã«Googleã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ„ãƒ¼ãƒ«ã€‚

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
    npm install -g @google/clasp

[https://script.google.com/home/usersettings](https://script.google.com/home/usersettings) ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ä¸‹è¨˜ã®ã‚ˆã†ãªè¨­å®šãŒã§ãã‚‹ã®ã§æœ‰åŠ¹ã«ã™ã‚‹ã€‚

<img class="in_article" src="/public/images/2021/01/ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ-2021-01-11-11.22.32-1024x202.png">
è‡ªåˆ†ã®ç’°å¢ƒã ã¨claspã®ãƒ‘ã‚¹ãŒé€šã£ã¦ãªã `command not found` ã«ãªã£ãŸã€‚nodenvã§ã„ã‚Œã¦ã„ã¦ `export PATH="~/.nodenv/shims:$PATH"` ã‚’ `.bashrc` ã«è¿½åŠ ã—ãŸã€‚

    $ clasp --version

2.3.0

ç„¡äº‹ãƒ‘ã‚¹ãŒé€šã£ãŸã€‚

## ãƒ­ã‚°ã‚¤ãƒ³
ãƒ­ã‚°ã‚¤ãƒ³ã®ç¢ºèªã€‚ã—ã¦ãªã•ãã†ã€‚

    $ clasp login --status

You are not logged in.

$ clasp login

Logging in globally...

(node:20018) ExperimentalWarning: The fs.promises API is experimental

ğŸ”‘ Authorize clasp by visiting this url:

Authorization successful.

Default credentials saved to: ~/.clasprc.json

ã‚³ãƒãƒ³ãƒ‰ã‚’æ‰“ã¤ã¨ç”»é¢é·ç§»ã—ã¦ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®é€£æºãŒã§ãã‚‹ã€‚

<img class="in_article" src="/public/images/2021/01/2021-01-11-11.52.50.png">
ç„¡äº‹ãƒ­ã‚°ã‚¤ãƒ³å®Œäº†ã€‚éšåˆ† ã‚·ãƒ³ãƒ—ãƒ«ãªãƒšãƒ¼ã‚¸ã€‚

## typescriptã‚’ä½¿ãˆã‚‹ã‚ˆã†ã«
typescriptã‚’ä½¿ã„ãŸã„ã®ãŒãƒ¡ã‚¤ãƒ³ã®ç›®çš„ãªã®ã§å‚è€ƒã«ã—ã¦ã„ã‚‹blogã‚’å‚è€ƒã«ç’°å¢ƒã‚’æº–å‚™ã—ã¦ã¿ã‚‹ã€‚

    $ mkdir hello-world

$ cd hello-world/

$ npm i -S @types/google-apps-script

$ tree

.

â”œâ”€â”€ node\_modules

â”‚&nbsp;&nbsp; â””â”€â”€ @types

â”‚&nbsp;&nbsp; â””â”€â”€ google-apps-script

â”‚&nbsp;&nbsp; â”œâ”€â”€ LICENSE

â”‚&nbsp;&nbsp; â”œâ”€â”€ README.md

â”‚&nbsp;&nbsp; â”œâ”€â”€ apis

â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ adsense\_v1\_4.d.ts

â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ analytics\_v3.d.ts

â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ analyticsreporting\_v4.d.ts

â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ appsactivity\_v1.d.ts

â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ bigquery\_v2.d.ts

â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ calendar\_v3.d.ts

â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ classroom\_v1.d.ts

â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ content\_v2.d.ts

â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ dfareporting\_v3\_3.d.ts

â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ directory\_v1.d.ts

â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ docs\_v1.d.ts

â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ drive\_v2.d.ts

â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ driveactivity\_v2.d.ts

â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ gmail\_v1.d.ts

â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ groupsmigration\_v1.d.ts

â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ groupssettings\_v1.d.ts

â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ licensing\_v1.d.ts

â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ mirror\_v1.d.ts

â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ peopleapi\_v1.d.ts

â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ reports\_v1.d.ts

â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ reseller\_v1.d.ts

â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ sheets\_v4.d.ts

â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ slides\_v1.d.ts

â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ tagmanager\_v2.d.ts

â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ tasks\_v1.d.ts

â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ youtube\_v3.d.ts

â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ youtubeanalytics\_v2.d.ts

â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â””â”€â”€ youtubepartner\_v1.d.ts

â”‚&nbsp;&nbsp; â”œâ”€â”€ google-apps-script-events.d.ts

â”‚&nbsp;&nbsp; â”œâ”€â”€ google-apps-script.base.d.ts

â”‚&nbsp;&nbsp; â”œâ”€â”€ google-apps-script.cache.d.ts

â”‚&nbsp;&nbsp; â”œâ”€â”€ google-apps-script.calendar.d.ts

â”‚&nbsp;&nbsp; â”œâ”€â”€ google-apps-script.card-service.d.ts

â”‚&nbsp;&nbsp; â”œâ”€â”€ google-apps-script.charts.d.ts

â”‚&nbsp;&nbsp; â”œâ”€â”€ google-apps-script.conference-data.d.ts

â”‚&nbsp;&nbsp; â”œâ”€â”€ google-apps-script.contacts.d.ts

â”‚&nbsp;&nbsp; â”œâ”€â”€ google-apps-script.content.d.ts

â”‚&nbsp;&nbsp; â”œâ”€â”€ google-apps-script.data-studio.d.ts

â”‚&nbsp;&nbsp; â”œâ”€â”€ google-apps-script.document.d.ts

â”‚&nbsp;&nbsp; â”œâ”€â”€ google-apps-script.drive.d.ts

â”‚&nbsp;&nbsp; â”œâ”€â”€ google-apps-script.forms.d.ts

â”‚&nbsp;&nbsp; â”œâ”€â”€ google-apps-script.gmail.d.ts

â”‚&nbsp;&nbsp; â”œâ”€â”€ google-apps-script.groups.d.ts

â”‚&nbsp;&nbsp; â”œâ”€â”€ google-apps-script.html.d.ts

â”‚&nbsp;&nbsp; â”œâ”€â”€ google-apps-script.jdbc.d.ts

â”‚&nbsp;&nbsp; â”œâ”€â”€ google-apps-script.language.d.ts

â”‚&nbsp;&nbsp; â”œâ”€â”€ google-apps-script.lock.d.ts

â”‚&nbsp;&nbsp; â”œâ”€â”€ google-apps-script.mail.d.ts

â”‚&nbsp;&nbsp; â”œâ”€â”€ google-apps-script.maps.d.ts

â”‚&nbsp;&nbsp; â”œâ”€â”€ google-apps-script.optimization.d.ts

â”‚&nbsp;&nbsp; â”œâ”€â”€ google-apps-script.properties.d.ts

â”‚&nbsp;&nbsp; â”œâ”€â”€ google-apps-script.script.d.ts

â”‚&nbsp;&nbsp; â”œâ”€â”€ google-apps-script.sites.d.ts

â”‚&nbsp;&nbsp; â”œâ”€â”€ google-apps-script.slides.d.ts

â”‚&nbsp;&nbsp; â”œâ”€â”€ google-apps-script.spreadsheet.d.ts

â”‚&nbsp;&nbsp; â”œâ”€â”€ google-apps-script.types.d.ts

â”‚&nbsp;&nbsp; â”œâ”€â”€ google-apps-script.url-fetch.d.ts

â”‚&nbsp;&nbsp; â”œâ”€â”€ google-apps-script.utilities.d.ts

â”‚&nbsp;&nbsp; â”œâ”€â”€ google-apps-script.xml-service.d.ts

â”‚&nbsp;&nbsp; â”œâ”€â”€ index.d.ts

â”‚&nbsp;&nbsp; â””â”€â”€ package.json

â””â”€â”€ package-lock.json

4 directories, 64 files

$ touch tsconfig.json

$ vim tsconfig.json

$ cat tsconfig.json

{

"compilerOptions": {

"lib": ["es2019"],

"experimentalDecorators": true

}

}

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ
    $ clasp create --title "Hello World" --type standalone

(node:20839) ExperimentalWarning: The fs.promises API is experimental

Created new standalone script: https://script.google.com/d/1QoTkRYwxa\_vHJEOdVZk2rKvI8jZ3c2JdahkGcrF\_RAgX3wpmN8cpAzYe/edit

Warning: files in subfolder are not accounted for unless you set a '.claspignore' file.

Cloned 1 file.

â””â”€ appsscript.json

ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã‚’ Asia/Tokyoã«å¤‰æ›´ã™ã‚‹

    $ cat appsscript.json

{

"timeZone": "America/New\_York",

"dependencies": {

},

"exceptionLogging": "STACKDRIVER",

"runtimeVersion": "V8"

## codeã‚’æ›¸ã„ã¦ã„ã
    const greeter = (person: string) => {

return `Hello, ${person}!`;

}

function testGreeter() {

const user = 'Ken';

Logger.log(greeter(user));

}

    $ clasp push

(node:21224) ExperimentalWarning: The fs.promises API is experimental

? Manifest file has been updated. Do you want to push and overwrite? Yes

â””â”€ appsscript.json

â””â”€ hello.ts

Pushed 2 files.

$ clasp open

(node:21322) ExperimentalWarning: The fs.promises API is experimental

Opening script: https://script.google.com/d/xxxxxx/edit

ãƒ–ãƒ©ã‚¦ã‚¶ãŒãŸã¡ã‚ãŒã‚Šã¾ã™

<img class="in_article" src="/public/images/2021/01/ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ-2021-01-11-15.36.52-1024x469.png">
testGreeter ã‚’å®Ÿè¡Œã—ã¦ã¿ã‚‹

<img class="in_article" src="/public/images/2021/01/ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ-2021-01-11-15.38.13-1024x370.png">
ã¡ã‚ƒã‚“ã¨ã§ã¦ãŸï¼

<img class="in_article" src="/public/images/2021/01/ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ-2021-01-11-15.39.07-1024x718.png">
ã“ã‚Œã§ãªã‚“ã¨ãªãæ‰‹é †ã¯ã‚ã‹ã£ãŸã€‚æ¬¡ã‹ã‚‰typescriptã®å­¦ç¿’ã‚’ã‚„ã£ã¦ãã€‚

* * *
å‚è€ƒ

ãƒ»[https://panda-program.com/posts/clasp-typescript](https://panda-program.com/posts/clasp-typescript) ã»ã¨ã‚“ã©ã“ã®é€šã‚Šã«ä½œæ¥­ã•ã›ã¦ã„ãŸã ãã¾ã—ãŸã€‚


