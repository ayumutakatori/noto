---
title: "雑感: postfix + dovecot + mysql + roundcube でメールサーバを構築"
layout: posts.liquid
is_draft: false
published_date: 2015-07-23 18:50:05 +0900
categories: ["Centos"]
tags: []
---

仕事でWEBメールの導入がありそうだったので調べ物をしてみました。今回は感想だけです。  
他にも構築手順を掲載しているサイトはたくさんあるので、そちらを参考にしてください。

#### 参考にしたサイト
[Postfix + Dovecot 2 + PostfixAdmin + MySQL](http://e-garakuta.net/techinfo/doku.php/linux/postfix-virtual)  
バーチャル設定で構築したかった用途にぴったりだったので今回は主にこちらを参考にさせていただきました。  
ありがとうございます。

[CentOS Roundcubeの設定](http://www.unix-power.net/linux/roundcube.html)  
roundcubeの設定に関してはこちらを参考にしました。ありがとうございます。

#### はじめに
いままで、

- postfix
- dovecot
- postfixadmin
- roundcube
のどれも構築したかったため、予備知識全くなくのスタートでしたが、  
一応最終的には動いて利用ができるところまでは構築出来ました。  
要した時間はだいたい6時間程度でしょうか。

#### postfixの設定について感想
一番最後まで手を焼いたのがpostfixでした。tlsの設定がうまくいかず、submissonで受けられない問題がなかなか解決しませんでした。  
master.confでは受けられるように書かれているんですが、どうもSTARTTLSで蹴られているログが見えるきがする。

main.cf

    # 前
    smtpd_use_tls = no

    # 修正
    smtpd_tls_security_level = encrypt

    上記の様になっていたのを修正しました。そもそもTLSを使わないようにしていたんですね。
    印象としてはとにかく設定できる項目がものすごく多いイメージです。
    apacheもそうですが、プラグインまで含めると広大すぎて学びきれないイメージでした。

    dovecotについて

    dovecotは比較的今回のサイトでは修正箇所がすくなかったのであまりはまらずに進めました。
    認証をdovecotに依頼する構成をとっていたので、今後深くする必要があると思います。

    postfixadmin

    これもあまり深くはまらず。乗っ取られるとやられまくるので色々対策を撮らないといけない項目ですね。

    roundcubeについて

    今回WEBメールにかんして4つほどソフトウェアを選定してい比較していたんですが、
    一番最初に調べようとしていたのがこちらでした。
    機能と導入のしやすさのバランスで一番良かったところがポイントでした。
    具体的にはスクワールメールよりもレガシーではないことと、yumでのインストールができるので
    脆弱性の対応も比較的用意かと思われたためです。

    実際、インストールもyumで入れてデータベースの設定を行った後はwordpress的にだいたいが画面での設定だったので
    比較的容易でした（ただしimapのテスト設定でめちゃくちゃはまりしました、これはどちらかというとdovecot）

    おわりに

    メールは依然攻撃がものすごく多いところで、かつ認証周りと関わりが深いのであまり安易な設定ができない印象です。
    これから理解を深めていき、意味をわかって構築をする必要があります。今はあまりにもただ動いているだけすぎる。

    puppetで構築ができるようになったあたりで、あらためて技術的な内容で記事を新しく作成しようと思います。
    とりあえず、特にこだわりがなければGmailとか使ったほうが安心だな・・・と思いました。個人でSSL用意しようと思うとお金もかかるし・・・


